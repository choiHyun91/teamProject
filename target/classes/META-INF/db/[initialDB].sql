DROP TABLE BOOKINGSEAT;
DROP TABLE BOOKING;
DROP TABLE SEATSTATE;
DROP TABLE SEAT;
DROP TABLE TIME;
DROP TABLE SCREENUP;
DROP TABLE SCREEN;
DROP TABLE CINEMA;
DROP TABLE MOVIERATING;
DROP TABLE MOVIE;
DROP TABLE PURCHASEITEM;
DROP TABLE ITEM;
DROP TABLE PURCHASE;
DROP TABLE EVENT;
DROP TABLE QNA;
DROP TABLE NOTICE;
DROP TABLE ADMIN;
DROP TABLE MEMBER;
DROP TABLE MEMBERGRADE;

DROP SEQUENCE NOTICESEQUENCE;
DROP SEQUENCE MOVIE_SEQ;
DROP SEQUENCE MOVIERATING_SEQ;
DROP SEQUENCE SCREENUP_SEQ;
DROP SEQUENCE SEATSTATE_SEQ;
DROP SEQUENCE BOOKING_SEQ;
DROP SEQUENCE BOOKINGSEAT_SEQ;
DROP SEQUENCE EVENT_SEQ;
DROP SEQUENCE ITEM_SEQ;
DROP SEQUENCE PURCHASE_SEQ;
DROP SEQUENCE PURCHASEITEM_SEQ;
DROP SEQUENCE QNA_SEQ;
CREATE SEQUENCE NOTICESEQUENCE MAXVALUE 999999 NOCACHE NOCYCLE;
CREATE SEQUENCE MOVIE_SEQ MAXVALUE 9999999999 NOCYCLE NOCACHE;
CREATE SEQUENCE MOVIERATING_SEQ MAXVALUE 9999999999 NOCYCLE NOCACHE;
CREATE SEQUENCE SCREENUP_SEQ MAXVALUE 9999999999 NOCYCLE NOCACHE;
CREATE SEQUENCE SEATSTATE_SEQ MAXVALUE 9999999999 NOCYCLE NOCACHE;
CREATE SEQUENCE BOOKING_SEQ MAXVALUE 9999999999 NOCYCLE NOCACHE;
CREATE SEQUENCE BOOKINGSEAT_SEQ MAXVALUE 9999999999 NOCYCLE NOCACHE;
CREATE SEQUENCE EVENT_SEQ MAXVALUE 999999 NOCACHE NOCYCLE;
CREATE SEQUENCE ITEM_SEQ MAXVALUE 999999 NOCACHE NOCYCLE;
CREATE SEQUENCE PURCHASE_SEQ MAXVALUE 999999 NOCACHE NOCYCLE;
CREATE SEQUENCE PURCHASEITEM_SEQ MAXVALUE 999999 NOCACHE NOCYCLE;
CREATE SEQUENCE QNA_SEQ  NOCYCLE NOCACHE;

CREATE TABLE ADMIN(
    AdminId VARCHAR2(30) PRIMARY KEY,
    AdminPw VARCHAR2(30) NOT NULL
);
CREATE TABLE MEMBERGRADE (
    MemberGradeNo VARCHAR2(20) PRIMARY KEY,
    MemberGradeName VARCHAR2(20) NOT NULL
);
CREATE TABLE MEMBER (
    MemberId VARCHAR2(30) PRIMARY KEY,
    MemberPw VARCHAR2(30) NOT NULL,
    MemberName VARCHAR2(30) NOT NULL,
    MemberBirth DATE NOT NULL,
    MemberPhone VARCHAR2(30) NOT NULL,
    MemberEmail VARCHAR2(100) NOT NULL,
    MemberAddress VARCHAR2(255) NOT NULL,
    MemberPost VARCHAR2(255) NOT NULL,
    MemberPoint NUMBER(8) DEFAULT 0 NOT NULL,
    MemberGradeNo VARCHAR2(20) DEFAULT 0 REFERENCES MEMBERGRADE(MemberGradeNo),
    MemberAmount NUMBER(10) DEFAULT 0 NOT NULL,
    MemberState NUMBER(1) DEFAULT 0 NOT NULL
);
CREATE TABLE NOTICE(
    NoticeNo NUMBER(10) PRIMARY KEY,
    NoticeTitle VARCHAR2(300) NOT NULL,
    NoticeContent VARCHAR2(1000),
    NoticeFile VARCHAR2(300),
    NoticeReadCount NUMBER(10) DEFAULT 0 NOT NULL,
    NoticeDate DATE DEFAULT SYSDATE
);


CREATE TABLE MOVIE (
    MovieNo NUMBER(10) PRIMARY KEY,
    MovieName VARCHAR2(200) NOT NULL,
    MovieDirector VARCHAR2(100) NOT NULL,
    MovieActor VARCHAR2(500) NOT NULL,
    MovieGenre VARCHAR2(20) NOT NULL,
    MovieCountry VARCHAR2(30) NOT NULL,
    MovieGrade VARCHAR2(30) NOT NULL,
    MovieRunningtime VARCHAR2(30) NOT NULL,
    MovieRelease DATE NOT NULL,
    MovieImage VARCHAR2(200) NOT NULL,
    MovieTrailer VARCHAR2(50) NOT NULL,
    MovieStory VARCHAR2(4000)
);
CREATE TABLE MOVIERATING (
    MovieRatingNo NUMBER(10) PRIMARY KEY,
    MovieNo REFERENCES MOVIE(MovieNo),
    MemberId REFERENCES MEMBER(MemberId),
    MovieRatingPoint NUMBER(2) NOT NULL,
    MovieRatingComment VARCHAR2(300)
);
CREATE TABLE CINEMA (
    CinemaNo VARCHAR2(20) PRIMARY KEY,
    CinemaName VARCHAR2(30) NOT NULL
);
CREATE TABLE SCREEN (
    ScreenNo VARCHAR2(20) PRIMARY KEY,
    ScreenName VARCHAR2(20) NOT NULL,
    CinemaNo REFERENCES CINEMA(CinemaNo)
);
CREATE TABLE SCREENUP (
    ScreenupNo NUMBER(10) PRIMARY KEY,
    MovieNo REFERENCES MOVIE(MovieNo),
    ScreenNo REFERENCES SCREEN(ScreenNo),
    ScreenupStartdate DATE NOT NULL,
    ScreenupEnddate DATE NOT NULL
);
CREATE TABLE TIME (
    TimeNo VARCHAR2(20) PRIMARY KEY,
    TimeSet VARCHAR2(30) NOT NULL
);
CREATE TABLE SEAT (
    SeatNo VARCHAR2(10) PRIMARY KEY,
    SeatRow VARCHAR2(20) NOT NULL,
    SeatCol NUMBER(2) NOT NULL
);
CREATE TABLE SEATSTATE (
    SeatStateNo NUMBER(10) PRIMARY KEY,
    SeatNo REFERENCES SEAT(SeatNo),
    TimeNo REFERENCES TIME(TimeNo),
    ScreenNo REFERENCES SCREEN(ScreenNo),
    SeatStateDate DATE NOT NULL
);
CREATE TABLE BOOKING (
    BookingNo NUMBER(10) PRIMARY KEY,
    ScreenupNo REFERENCES SCREENUP(ScreenupNo),
    MemberId REFERENCES MEMBER(MemberId),
    TimeNo REFERENCES TIME(TimeNo),
    BookingDate DATE NOT NULL,
    BookingCount NUMBER(1) NOT NULL,
    BookingPrice NUMBER(6) NOT NULL
);
CREATE TABLE BOOKINGSEAT (
    BookingSeatNo NUMBER(10) PRIMARY KEY,
    BookingNo REFERENCES BOOKING(BookingNo),
    SeatNo REFERENCES SEAT(SeatNo)
);


CREATE TABLE EVENT(
    EventNo NUMBER(10) PRIMARY KEY,
    EventTitle VARCHAR2(200) NOT NULL,
    EventFile VARCHAR2(300) NOT NULL,
    EventReadCount NUMBER(10) DEFAULT 0,
    EventDate DATE DEFAULT SYSDATE
);
CREATE TABLE ITEM(
    ItemNo NUMBER(10) PRIMARY KEY,
    ItemName VARCHAR2(200) NOT NULL,
    ItemImage VARCHAR2(200) NOT NULL,
    ItemPrice NUMBER(6) NOT NULL
);
CREATE TABLE PURCHASE(
    PurchaseNo NUMBER(10) PRIMARY KEY,
    MemberId VARCHAR2(30) NOT NULL REFERENCES MEMBER(MEMBERID),
    PurchasePrice NUMBER(6) NOT NULL,
    PurchaseDate DATE DEFAULT SYSDATE
);
CREATE TABLE PURCHASEITEM(
    PurchaseItemNo NUMBER(10) PRIMARY KEY,
    ItemNo NUMBER(10) REFERENCES ITEM(ItemNo),
    PurchaseNo NUMBER(10) REFERENCES PURCHASE(PurchaseNo)
);



CREATE TABLE QNA(
    QNANO NUMBER(10) PRIMARY KEY,
    QNATITLE VARCHAR2(200) NOT NULL,
    QNACONTENT VARCHAR2(2000) NOT NULL,
    QNAFILE VARCHAR2(200) ,
    QNAHIT NUMBER(6)DEFAULT 0 ,
    QNADATE DATE NOT NULL,
    QNAIP VARCHAR2(200) ,
    QNANOPW VARCHAR2(20),
    QNAGROUP NUMBER(3) NOT NULL,
    QNASTEP NUMBER(3) DEFAULT 1,
    QNAINDENT NUMBER(3) DEFAULT 0,
    MEMBERID VARCHAR2(30) REFERENCES MEMBER(MEMBERID),
    ADMINID VARCHAR2(30) REFERENCES ADMIN(ADMINID)
);

-- 관리자 등록
INSERT INTO ADMIN(adminid, AdminPw) VALUES('admin', 'admin');

-- 멤버등급 등록
INSERT INTO MEMBERGRADE(MemberGradeNo, MemberGradeName) VALUES('0', 'NORMAL');
INSERT INTO MEMBERGRADE(MemberGradeNo, MemberGradeName) VALUES('1', 'VIP');

-- 영화관 기본데이터 입력
INSERT INTO CINEMA VALUES ('YONGSAN', 'MAC용산아이파크몰');
INSERT INTO CINEMA VALUES ('GANGNAM', 'MAC강남');
INSERT INTO CINEMA VALUES ('MIA', 'MAC미아');
INSERT INTO CINEMA VALUES ('HONGDAE', 'MAC홍대');
INSERT INTO CINEMA VALUES ('DONGDAEMUN', 'MAC동대문');

-- 상영관(스크린) 기본데이터 입력
INSERT INTO SCREEN VALUES ('Y01', '용산1관', 'YONGSAN');
INSERT INTO SCREEN VALUES ('Y02', '용산2관', 'YONGSAN');
INSERT INTO SCREEN VALUES ('Y03', '용산3관', 'YONGSAN');
INSERT INTO SCREEN VALUES ('Y04', '용산4관', 'YONGSAN');
INSERT INTO SCREEN VALUES ('Y05', '용산5관', 'YONGSAN');
INSERT INTO SCREEN VALUES ('G01', '강남1관', 'GANGNAM');
INSERT INTO SCREEN VALUES ('G02', '강남2관', 'GANGNAM');
INSERT INTO SCREEN VALUES ('G03', '강남3관', 'GANGNAM');
INSERT INTO SCREEN VALUES ('G04', '강남4관', 'GANGNAM');
INSERT INTO SCREEN VALUES ('G05', '강남5관', 'GANGNAM');
INSERT INTO SCREEN VALUES ('M01', '미아1관', 'MIA');
INSERT INTO SCREEN VALUES ('M02', '미아2관', 'MIA');
INSERT INTO SCREEN VALUES ('M03', '미아3관', 'MIA');
INSERT INTO SCREEN VALUES ('M04', '미아4관', 'MIA');
INSERT INTO SCREEN VALUES ('M05', '미아5관', 'MIA');
INSERT INTO SCREEN VALUES ('H01', '홍대1관', 'HONGDAE');
INSERT INTO SCREEN VALUES ('H02', '홍대2관', 'HONGDAE');
INSERT INTO SCREEN VALUES ('H03', '홍대3관', 'HONGDAE');
INSERT INTO SCREEN VALUES ('H04', '홍대4관', 'HONGDAE');
INSERT INTO SCREEN VALUES ('H05', '홍대5관', 'HONGDAE');
INSERT INTO SCREEN VALUES ('D01', '동대문1관', 'DONGDAEMUN');
INSERT INTO SCREEN VALUES ('D02', '동대문2관', 'DONGDAEMUN');
INSERT INTO SCREEN VALUES ('D03', '동대문3관', 'DONGDAEMUN');
INSERT INTO SCREEN VALUES ('D04', '동대문4관', 'DONGDAEMUN');
INSERT INTO SCREEN VALUES ('D05', '동대문5관', 'DONGDAEMUN');

-- 좌석 기본데이터 입력
BEGIN
FOR i IN 1..10 LOOP
    BEGIN
    FOR j IN 1..10 LOOP
    INSERT INTO SEAT (SEATNO, SEATROW, SEATCOL)
        VALUES (CONCAT(CHR(64+j), i), CHR(64+j), i);
    END LOOP;
    END;
END LOOP;
END;
/

-- 시간(상영시간) 기본데이터 입력
INSERT INTO TIME VALUES ('8', '08:00');
INSERT INTO TIME VALUES ('11', '11:00');
INSERT INTO TIME VALUES ('14', '14:00');
INSERT INTO TIME VALUES ('17', '17:00');
INSERT INTO TIME VALUES ('20', '20:00');
INSERT INTO TIME VALUES ('23', '23:00');
select * from member;

COMMIT;